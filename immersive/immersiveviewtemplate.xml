<Ui xmlns="http://www.blizzard.com/wow/ui/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.blizzard.com/wow/ui/
..\FrameXML\UI.xsd">

    <Button name="GwChoiceTitleButtonTemplate" hidden="true" virtual="true" mixin="GwGossipTitleButtonMixin">
		<Layers>
			<Layer level="OVERLAY">
				<Texture parentKey="Icon">
					<Size x="20" y="20"/>
					<Anchors>
						<Anchor point="LEFT" x="16"/> 
					</Anchors>
				</Texture>
			</Layer>
			<Layer level="ARTWORK">
				<FontString parentKey="Label" inherits="DialogButtonHighlightText" justifyH="LEFT" wordwrap="true">
					<Anchors>
						<Anchor point="LEFT" x="42"/>
						<Anchor point="RIGHT"/>
					</Anchors>
				</FontString>
			</Layer>
		</Layers>
		<Scripts>
			<OnClick method="OnClick"/>
			<OnShow method="OnShow"/>
			<OnEnter method="OnEnter"/>
			<OnLeave method="OnLeave"/>
		</Scripts>
	</Button>
	<!--inherits="QuestInfoRewardSpellCodeTemplate" -->
	<Button name="GwRewardSpellCodeTemplate"  virtual="true">
		<Scripts>
			<OnEnter>
				GameTooltip:SetOwner(self, "ANCHOR_RIGHT");
				GameTooltip:SetQuestRewardSpell(self.rewardSpellIndex);
			</OnEnter>
			<OnClick>
				if (IsModifiedClick("CHATLINK")) then
					ChatEdit_InsertLink(GetQuestSpellLink(self.rewardSpellIndex));
				end
			</OnClick>
			<OnLeave>
				GameTooltip:Hide();
				ResetCursor();
			</OnLeave>
		</Scripts>
	</Button>
	<!--inherits="QuestInfoRewardItemCodeTemplate" -->
	<Button name="GwGossipRewardItemCodeTemplate" virtual="true">
		<Scripts>
			<OnEnter>
				GameTooltip:SetIgnoreParentAlpha(true);
				GameTooltip:SetOwner(self, "ANCHOR_TOPRIGHT", 0, 0);
				if (self.objectType == "item") then
					GameTooltip:SetQuestItem(self.type, self:GetID());
					GameTooltip_ShowCompareItem(GameTooltip);
				elseif (self.objectType == "currency") then
					GameTooltip:SetQuestCurrency(self.type, self:GetID());
				elseif (self.objectType == "questSessionBonusReward") then
					GameTooltip:SetItemByID(self:GetID());
					GameTooltip_ShowCompareItem(GameTooltip);
				end
				CursorUpdate(self);
			</OnEnter>
			<OnClick>
				if  (IsModifiedClick() and self.objectType == "item") then
					HandleModifiedItemClick(GetQuestItemLink(self.type, self:GetID()));
				else
					if (self:GetParent() and self:GetParent().chooseItems and self.type == "choice" ) then
						self:GetParent().ItemHighlight:SetPoint('TOPLEFT', self, 0, 0);
						self:GetParent().ItemHighlight:Show();
						self:GetParent().ItemHighlight.InAnim:Stop();
						self:GetParent().ItemHighlight.InAnim:Play();
					end
				end
			</OnClick>
			<OnDoubleClick>
				if (not IsModifiedClick() and self:GetParent() and self:GetParent().chooseItems and self.type == "choice") then
					GetQuestReward(self:GetID());
				end
			</OnDoubleClick>
			<OnLeave>
				GameTooltip:SetIgnoreParentAlpha(false);
				GameTooltip:Hide();
				ResetCursor();
			</OnLeave>
			<OnUpdate>
				CursorOnUpdate(self, elapsed);
			</OnUpdate>
		</Scripts>
	</Button>
	<!--inherits="QuestSpellTemplate" -->
	<Button name="GwQuestSpellTemplate" hidden="true" virtual="true">
		<Size x="180" y="38"/>
		<HitRectInsets left="0" right="0" top="0" bottom="14"/>
		<Layers>
			<Layer level="BACKGROUND">
				<Texture parentKey="Icon" name="$parentIconTexture">
					<Size x="38" y="38"/>
					<Anchors>
						<Anchor point="TOPLEFT" x="10" y="-2"/>
					</Anchors>
				</Texture>
				<Texture parentKey="NameFrame" name="$parentNameFrame" file="Interface\QuestFrame\UI-QuestItemNameFrame">
					<Size x="190" y="42"/>
					<Anchors>
						<Anchor point="LEFT" relativeKey="$parent.Icon" relativePoint="RIGHT" x="-20" y="0"/>
					</Anchors>
				</Texture>
			</Layer>
			<Layer level="OVERLAY">
				<Texture name="$parentSpellBorder"  file="Interface\Spellbook\Spellbook-Parts">
					<Size x="70" y="65"/>
					<TexCoords left="0.00390625" right="0.27734375" top="0.44140625" bottom="0.69531250"/>
					<Anchors>
						<Anchor point="CENTER" relativeKey="$parent.Icon" x="2" y="0"/>
					</Anchors>
				</Texture>
				<FontString parentKey="Name" name="$parentName" inherits="GameFontHighlight" justifyH="LEFT" >
					<Size  x="130" y="38"/>
					<Anchors>
						<Anchor point="LEFT" relativeKey="$parent.NameFrame" x="30" y="0"/>
					</Anchors>
				</FontString>
			</Layer>
		</Layers>
		<Scripts>
			<OnEnter>
				if (self.spellID) then
					GameTooltip:SetOwner(self, "ANCHOR_RIGHT");
					GameTooltip:SetSpellByID(self.spellID);
				end
			</OnEnter>
			<OnLeave>
				GameTooltip:Hide();
			</OnLeave>
			<OnClick>
				if ( IsModifiedClick("CHATLINK") and self.spellID) then
					local spellLink = GetSpellLink(self.spellID);
					ChatEdit_InsertLink(spellLink);
				end
			</OnClick>
		</Scripts>
	</Button>

	<Button name="GwGossipItemButtonTemplate" registerForClicks="LeftButtonUp, RightButtonUp" virtual="true">
		<Size x="180" y="38" />
		<Layers>
			<Layer level="BACKGROUND" textureSubLevel="1">
				<Texture parentKey="Icon">
					<Size x="38" y="38" />
					<Anchors>
						<Anchor point="TOPLEFT" />
					</Anchors>
				</Texture>
			</Layer>

			<Layer level="BACKGROUND" textureSubLevel="0">
				 <Texture parentKey="NameFrame" file="Interface\QuestFrame\UI-QuestItemNameFrame" >
					<Size x="190" y="42" />
					<Anchors>
						<Anchor point="LEFT" relativeKey="$parent.Icon" relativePoint="CENTER" x="-10" y="0" />
					</Anchors>
				</Texture> 
			</Layer>

			<Layer level="OVERLAY">
				<Texture parentKey="IconOverlay" hidden="true">
					<Anchors>
						<Anchor point="TOPLEFT" relativeKey="$parent.Icon"/>
						<Anchor point="BOTTOMRIGHT" relativeKey="$parent.Icon"/>
					</Anchors>
				</Texture>
			</Layer>

			<Layer level="BORDER">
				<FontString inherits="GameFontHighlight" justifyH="LEFT" parentKey="Name" wordwrap="true">
					<Size x="130" y="38" />
					<Anchors>
						<Anchor point="LEFT" relativeKey="$parent.Icon" relativePoint="RIGHT" x="8" y="0" />
					</Anchors>
				</FontString>
			</Layer>

			<Layer level="ARTWORK">
				<Texture parentKey="IconBorder" file="Interface/AddOns/GW2_UI/textures/questview/fsgvf_item_icon_border">
				<Size x="38" y="38" />
					<Anchors>
						<Anchor point="CENTER" relativeKey="$parent.Icon" relativePoint="CENTER"/>
					</Anchors>
				</Texture>

				<FontString name="$parentCount" inherits="NumberFontNormal" justifyH="RIGHT" parentKey="Count">
					<Anchors>
						<Anchor point="BOTTOMRIGHT" relativeKey="$parent.Icon" x="-3" y="4" />
					</Anchors>
				</FontString>
			</Layer>
		</Layers>									
	</Button>
	
	<Frame name="GwMoveFrameTemplate" enableMouse="true" movable="true" virtual="true">
		<Scripts>
			<OnLoad>
				self:RegisterForDrag("LeftButton");
				self.isMoving = true; 
			</OnLoad>
			<OnDragStart>
				if not self.isMoving then
					return;
				end

				self:GetParent():StartMoving();
			</OnDragStart>
			<OnDragStop>
				self:GetParent():StopMovingOrSizing();
			</OnDragStop>
		</Scripts>
	</Frame>

	<Frame name="GwSizerFrameTemplate" enableMouse="true" virtual="true">
	    <Size x="32" y="32"></Size>
        <Anchors>
            <Anchor point="BOTTOMRIGHT" relativePoint="BOTTOMRIGHT" x="0" y="0"></Anchor>
         </Anchors>
		 <Layers>
             <Layer level="OVERLAY">
                <Texture parentKey="texture" file="Interface/AddOns/GW2_UI/textures/uistuff/resize">
                	 <Size x="32" y="32"></Size>
                     <Anchors>
                         <Anchor point="BOTTOMRIGHT" x="0" y="0"></Anchor>
                     </Anchors>
                </Texture>
            </Layer>
        </Layers>
		<Scripts>
			<OnLoad>
				self.texture:SetDesaturated(true);
				self.isSizing = true; 
			</OnLoad>
			<OnEnter>
				self.texture:SetDesaturated(false);
			</OnEnter>
			<OnLeave>
				self.texture:SetDesaturated(true);
			</OnLeave>
			<OnMouseDown>
				if not self.isSizing or button~= "RightButton" then
					return;
				end
				
				self.GetScaleDistance = function ()
					local left, top = self.Left, self.Top;
					local scale = self.effectiveScale;
					local x, y = GetCursorPosition();
					x = x / scale - left;
					y = top - y / scale;
					return sqrt(x * x + y * y);
				end

                self.normalScale = self:GetParent():GetScale();
				self.effectiveScale = self:GetParent():GetEffectiveScale();
				self.Left = self:GetParent():GetLeft();
				self.Top = self:GetParent():GetTop();
				self.moveDistance = self.GetScaleDistance();

                self:SetScript("OnUpdate",function(self,elapsed)
					local scale = self.GetScaleDistance() / self.moveDistance * self.normalScale;
					self:GetParent():SetScale(scale);
                end)
			</OnMouseDown>
			<OnMouseUp>
				self:SetScript("OnUpdate", nil);
				self.normalScale = nil;
				self.effectiveScale = nil;
				self.Left = nil;
				self.Top = nil;
				self.moveDistance = nil;
			</OnMouseUp>
		</Scripts>
	</Frame>

	<Button name="GwGossipCheckButtonTemplate" virtual="true">
		<Size x="200" y="30"></Size>
		<Layers>
			<Layer level="OVERLAY" textureSubLevel="2">
				<FontString parentKey="title" text="Compact view" inherits="ChatBubbleFont" justifyH="LEFT">
					<Size x="200" y="30"/>
					<Color r="1" b="1" g="1"/>
					<Anchors>
						<Anchor point="LEFT" x="25" y="0"/>
					</Anchors>
				</FontString>
			</Layer>
		</Layers>
		<Frames>
			<CheckButton parentKey="checkbutton" checked="false">
				<HitRectInsets left="0" right="0" top="0" bottom="0"/>
				<Size x="16" y="16"/>
				<Anchors>
					<Anchor point="LEFT" relativePoint="LEFT" x="5"/>
				</Anchors>
				<NormalTexture file="Interface/AddOns/GW2_UI/textures/uistuff/checkbox"/>
				<CheckedTexture file="Interface/AddOns/GW2_UI/textures/uistuff/checkboxchecked"/>
			</CheckButton>
		</Frames>
	</Button>

	<Button name="GwGossipSliderTemplate" virtual="true">
		<Size x="200" y="45"></Size>
		<Layers>
			<Layer level="OVERLAY" textureSubLevel="2">
				<FontString parentKey="title" text="Compact view" inherits="ChatBubbleFont" justifyH="LEFT">
					<Size x="200" y="30"/>
					<Color r="1" b="1" g="1"/>
					<Anchors>
						<Anchor point="TOPLEFT" x="10" y="0"/>
					</Anchors>
				</FontString>
			</Layer>
		</Layers>
		<Frames>
			<Slider parentKey="slider" orientation="HORIZONTAL" enableMouse="true" virtual="true">
				<Size x="150" y="15"/>
				<Anchors>
					<Anchor point="TOPLEFT" relativeKey="$parent.title" relativePoint="BOTTOMLEFT" x="5" y="-5"/>
				</Anchors>
				<HitRectInsets left="0" right="0" top="-10" bottom="-10"/>
				<ThumbTexture file="Interface/AddOns/GW2_UI/textures/uistuff/sliderhandle">
					<Size x="16" y="16"/>
				</ThumbTexture>
				<Layers>
					<Layer>
						<Texture file="Interface/AddOns/GW2_UI/textures/uistuff/sliderbg">
							<Anchors>
								<Anchor point="TOPLEFT" relativePoint="TOPLEFT"/>
								<Anchor point="BOTTOMRIGHT" relativePoint="BOTTOMRIGHT"/>
							</Anchors>
						</Texture>
					</Layer>
				</Layers>
			</Slider>
			<EditBox parentKey="input" autoFocus="false">
				<Size x="25" y="15"/>
				<Anchors>
					<Anchor point="LEFT" relativeKey="$parent.slider" relativePoint="RIGHT" x="10" y="0"/>
				</Anchors>
				<Layers>
					<Layer level="BACKGROUND">
						<Texture file="Interface/AddOns/GW2_UI/textures/uistuff/gwstatusbar-bg">
							<Anchors>
								<Anchor point="TOPLEFT" x="-5" y="3"/>
								<Anchor point="BOTTOMRIGHT" x="5" y="-3"/>
							</Anchors>
							<TexCoords left="0" right="0.2" top="0" bottom="1.0"/>
						</Texture>
					</Layer>
				</Layers>
				<FontString inherits="GameFontNormalSmall">
					<Color r="1" b="1" g="1"/>
				</FontString>
			</EditBox>
		</Frames>
	</Button>
</Ui>