<Ui xmlns="http://www.blizzard.com/wow/ui/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.blizzard.com/wow/ui/
..\FrameXML\UI.xsd">

        <Frame name="GwTalentFrame" enableMouse="true" inherits="SecureHandlerBaseTemplate" protected="true" registerForClicks="LeftButtonUp" virtual="true">
        <Size x="608" y="621"></Size>
        <Anchors>
            <Anchor point="TOPLEFT" relativePoint="TOPLEFT" x="245" y="-5"></Anchor>
        </Anchors>
        <Layers>
            <Layer level="BACKGROUND">

                <Texture  file="Interface\AddOns\GW2_UI\textures\talents\talents_header">
                    <Size x="512" y="32"></Size>
                    <Anchors>
                        <Anchor point="TOPLEFT" relativePoint="TOPLEFT" x="10" y="-10"></Anchor>
                    </Anchors>
                </Texture>
            </Layer>
            <Layer level="BORDER">
                <FontString parentKey="title" text="Passive" justifyH="LEFT" justifyY="CENTER">
                    <Size x="256" y="32"></Size>
                    <Anchors>
                       <Anchor point="TOPLEFT" relativePoint="TOPLEFT" x="20" y="-10"></Anchor>
                    </Anchors>
                </FontString>
            </Layer>

            </Layers>
            <Scripts>
                <OnLoad>


                    self.title:SetFont(DAMAGE_TEXT_FONT,14)
                    self.title:SetTextColor(1,1,1,1)
                    self.title:SetShadowColor(0,0,0,1)
                    self.title:SetShadowOffset(1,-1)
                    self.title:SetText(GwLocalization['TALENTS_SPEC_HEADER'] )


                    --self:RegisterEvent("PREVIEW_TALENT_POINTS_CHANGED");
                    self:RegisterEvent("UNIT_MODEL_CHANGED");
                    self:RegisterEvent("UNIT_LEVEL");
                    self:RegisterEvent("LEARNED_SPELL_IN_TAB");
                    --self:RegisterEvent("PLAYER_TALENT_UPDATE");
                    --self:RegisterEvent("PET_SPECIALIZATION_CHANGED");
                --    self:RegisterEvent("ACTIVE_TALENT_GROUP_CHANGED");
                --    self:RegisterEvent("PREVIEW_TALENT_PRIMARY_TREE_CHANGED");
                --    self:RegisterEvent("PLAYER_LEARN_TALENT_FAILED");
                </OnLoad>
            </Scripts>
    </Frame>

    <Frame name="GwTalentsLevelLabel" virtual="true">
        <Size x="30" y="30"></Size>
        <Layers>
            <Layer level="BORDER">
                 <FontString parentKey="title" text="0" justifyH="CENTER" justifyY="CENTER">
                    <Size x="32" y="32"></Size>
                    <Anchors>
                       <Anchor point="CENTER" relativePoint="CENTER" x="0" y="" ></Anchor>
                    </Anchors>
                </FontString>
            </Layer>
        </Layers>
        <Scripts>
            <OnLoad>

                    self.title:SetFont(DAMAGE_TEXT_FONT,14)
                    self.title:SetTextColor(0.7,0.7,0.7,1)
                    self.title:SetShadowColor(0,0,0,0)
                    self.title:SetShadowOffset(1,-1)

            </OnLoad>
        </Scripts>
    </Frame>


    <Button name="GwSpecFrame" enableMouse="true"  virtual="true">
        <Size x="588" y="140"></Size>
        <Anchors>
            <Anchor point="TOPLEFT" relativePoint="TOPLEFT" x="10" y="-10"></Anchor>
        </Anchors>
        <Layers>
            <Layer level="BACKGROUND">
                <Texture parentKey="background" file="Interface\AddOns\GW2_UI\textures\character\paperdollbg">
                    <Size x="588" y="140"></Size>
                    <Anchors>
                        <Anchor point="TOPLEFT" relativePoint="TOPLEFT" x="0" y="0"></Anchor>
                    </Anchors>
                </Texture>
            </Layer>
            <Layer level="ARTWORK">
                <Texture parentKey="icon" file="Interface\AddOns\GW2_UI\textures\character\paperdollbg">
                    <Size x="80" y="80"></Size>
                    <Anchors>
                        <Anchor point="LEFT" relativePoint="LEFT" x="20" y="0"></Anchor>
                    </Anchors>
                        <TexCoords left="0.1" right="0.9" top="0.1" bottom="0.9" />
                </Texture>
            </Layer>
            <Layer level="BORDER">
                <Texture parentKey="outline" file="Interface\AddOns\GW2_UI\textures\talents\passive_outline">
                    <Size x="90" y="90"></Size>
                      <Anchors>
                        <Anchor point="CENTER" relativeKey="$parent.icon" relativePoint="CENTER"  x="0"></Anchor>
                    </Anchors>
                </Texture>
            </Layer>
        </Layers>
        <Frames>
            <Frame parentKey="info" enableMouse="false">
                <Size x="460" y="140"></Size>
                <Anchors>
                    <Anchor point="RIGHT" relativePoint="RIGHT" x="0" y="0"></Anchor>
                </Anchors>
                 <Layers>
                     <Layer level="OVERLAY">
                         <Texture parentKey="background" file="Interface\AddOns\GW2_UI\textures\character\paperdollbg">

                             <Anchors>
                                 <Anchor point="TOPLEFT" relativePoint="TOPLEFT" x="0" y="0"></Anchor>
                                 <Anchor point="BOTTOMRIGHT" relativePoint="BOTTOMRIGHT" x="0" y="0"></Anchor>
                             </Anchors>
                             <Color a="0.6"></Color>
                               <TexCoords left="1" right="0" top="0" bottom="1" />
                         </Texture>
                     </Layer>
                     <Layer level="OVERLAY" textureSubLevel="">
                         <FontString parentKey="specTitle" text="Arcane" justifyH="LEFT">
                             <Size x="200" y="20"></Size>
                             <Anchors>
                                 <Anchor point="TOPLEFT" x="" y="-20"></Anchor>
                             </Anchors>
                         </FontString>
                         <FontString parentKey="specDesc" text="Arcane" justifyH="LEFT">
                             <Size x="400" y="50"></Size>
                             <Anchors>
                                 <Anchor point="TOPLEFT" relativeKey="$parent.specTitle" relativePoint="BOTTOMLEFT" x="" y="-5"></Anchor>
                             </Anchors>
                         </FontString>
                     </Layer>
                </Layers>
                <Scripts>
                    <OnLoad>


                        self.specTitle:SetFont(DAMAGE_TEXT_FONT,18)
                        self.specTitle:SetTextColor(1,1,1,1)
                        self.specTitle:SetShadowColor(0,0,0,1)
                        self.specTitle:SetShadowOffset(1,-1)

                        self.specDesc:SetFont(UNIT_NAME_FONT,14)
                        self.specDesc:SetTextColor(0.8,0.8,0.8,1)
                        self.specDesc:SetShadowColor(0,0,0,1)
                        self.specDesc:SetShadowOffset(1,-1)

                    </OnLoad>

                </Scripts>
                <Frames>
                    <Frame parentKey="spellPreview" enableMouse="false">
                    <Size x="460" y="140"></Size>
                    <Anchors>
                    <Anchor point="TOPLEFT"  relativeKey="$parent.specDesc" relativePoint="TOPLEFT" x="0" y="0"> </Anchor>
                    </Anchors>
                    </Frame>
                </Frames>
            </Frame>

        </Frames>
        <Scripts>
            <OnLoad>


                   self:RegisterForClicks("AnyUp");


                local mask = UIParent:CreateMaskTexture()
                mask:SetPoint("CENTER",self.icon,'CENTER',0,0)

                mask:SetTexture("Interface\\AddOns\\GW2_UI\\textures\\talents\\passive_border", "CLAMPTOBLACKADDITIVE", "CLAMPTOBLACKADDITIVE")
                mask:SetSize(80, 80)
                self.icon:AddMaskTexture(mask)
            </OnLoad>
            <OnEnter>

            </OnEnter>
            <OnLeave>

            </OnLeave>

            <OnShow>
                self:SetScript('OnUpdate',function(self,elapsed)
                    if MouseIsOver(self) then
                        local r,g,b,a = self.background:GetVertexColor()
                        self.background:SetVertexColor(r + (1 * elapsed),r + (1 * elapsed),r + (1 * elapsed),r + (1 * elapsed))
                        return
                    end
                    self.background:SetVertexColor(0.7,0.7,0.7,0.7)
                end)
            </OnShow>
            <OnHide>
                 self:SetScript('OnUpdate',nil)
            </OnHide>
            <OnUpdate>

            </OnUpdate>
            <OnClick>
                if not self.active then
                SetSpecialization(self.specIndex)
                end
            </OnClick>
        </Scripts>
    </Button>

    <Button name="GwPetSpecFrame" enableMouse="true"  virtual="true">
        <Size x="196" y="140"></Size>
        <Anchors>
            <Anchor point="TOPLEFT" relativePoint="TOPLEFT" x="10" y="-10"></Anchor>
        </Anchors>
        <Layers>
            <Layer level="BACKGROUND">
                <Texture parentKey="background" file="Interface\AddOns\GW2_UI\textures\character\paperdollbg">
                    <Size x="196" y="140"></Size>
                    <Anchors>
                        <Anchor point="TOPLEFT" relativePoint="TOPLEFT" x="0" y="0"></Anchor>
                    </Anchors>
                </Texture>
            </Layer>
            <Layer level="ARTWORK">
                <Texture parentKey="icon" file="Interface\AddOns\GW2_UI\textures\character\paperdollbg">
                    <Size x="80" y="80"></Size>
                    <Anchors>
                        <Anchor point="LEFT" relativePoint="LEFT" x="20" y="0"></Anchor>
                    </Anchors>
                        <TexCoords left="0.1" right="0.9" top="0.1" bottom="0.9" />
                </Texture>
            </Layer>
            <Layer level="BORDER">
                <Texture parentKey="outline" file="Interface\AddOns\GW2_UI\textures\talents\passive_outline">
                    <Size x="90" y="90"></Size>
                      <Anchors>
                        <Anchor point="CENTER" relativeKey="$parent.icon" relativePoint="CENTER"  x="0"></Anchor>
                    </Anchors>
                </Texture>
            </Layer>
        </Layers>
        <Frames>
            <Frame parentKey="info" enableMouse="false">
                <Size x="196" y="140"></Size>
                <Anchors>
                    <Anchor point="RIGHT" relativePoint="RIGHT" x="0" y="0"></Anchor>
                </Anchors>
                 <Layers>
                     <Layer level="OVERLAY">
                         <Texture parentKey="background" file="Interface\AddOns\GW2_UI\textures\character\paperdollbg">

                             <Anchors>
                                 <Anchor point="TOPLEFT" relativePoint="TOPLEFT" x="0" y="0"></Anchor>
                                 <Anchor point="BOTTOMRIGHT" relativePoint="BOTTOMRIGHT" x="0" y="0"></Anchor>
                             </Anchors>
                             <Color a="0.6"></Color>
                               <TexCoords left="1" right="0" top="0" bottom="1" />
                         </Texture>
                     </Layer>
                     <Layer level="OVERLAY" textureSubLevel="">
                         <FontString parentKey="specTitle" text="Arcane" justifyH="LEFT">
                             <Size x="200" y="20"></Size>
                             <Anchors>
                                 <Anchor point="TOPLEFT" x="" y="-20"></Anchor>
                             </Anchors>
                         </FontString>
                         <FontString parentKey="specDesc" text="Arcane" justifyH="LEFT">
                             <Size x="400" y="50"></Size>
                             <Anchors>
                                 <Anchor point="TOPLEFT" relativeKey="$parent.specTitle" relativePoint="BOTTOMLEFT" x="" y="-5"></Anchor>
                             </Anchors>
                         </FontString>
                     </Layer>
                </Layers>
                <Scripts>
                    <OnLoad>


                        self.specTitle:SetFont(DAMAGE_TEXT_FONT,18)
                        self.specTitle:SetTextColor(1,1,1,1)
                        self.specTitle:SetShadowColor(0,0,0,1)
                        self.specTitle:SetShadowOffset(1,-1)

                        self.specDesc:SetFont(UNIT_NAME_FONT,14)
                        self.specDesc:SetTextColor(0.8,0.8,0.8,1)
                        self.specDesc:SetShadowColor(0,0,0,1)
                        self.specDesc:SetShadowOffset(1,-1)

                    </OnLoad>

                </Scripts>
            </Frame>
        </Frames>
        <Scripts>
            <OnLoad>

                   self:RegisterForClicks("AnyUp");


                local mask = UIParent:CreateMaskTexture()
                mask:SetPoint("CENTER",self.icon,'CENTER',0,0)

                mask:SetTexture("Interface\\AddOns\\GW2_UI\\textures\\talents\\passive_border", "CLAMPTOBLACKADDITIVE", "CLAMPTOBLACKADDITIVE")
                mask:SetSize(80, 80)
                self.icon:AddMaskTexture(mask)
            </OnLoad>
            <OnEnter>

            </OnEnter>
            <OnLeave>

            </OnLeave>

            <OnShow>
                self:SetScript('OnUpdate',function(self,elapsed)
                    if MouseIsOver(self) then
                        local r,g,b,a = self.background:GetVertexColor()
                        self.background:SetVertexColor(r + (1 * elapsed),r + (1 * elapsed),r + (1 * elapsed),r + (1 * elapsed))
                        return
                    end
                    self.background:SetVertexColor(0.7,0.7,0.7,0.7)
                end)
            </OnShow>
            <OnHide>
                 self:SetScript('OnUpdate',nil)
            </OnHide>
            <OnUpdate>

            </OnUpdate>
            <OnClick>
                if not self.active then
                SetSpecialization(self.specIndex)
                end
            </OnClick>
        </Scripts>
    </Button>


    <Button name="GwTalentButton" registerForClicks="AnyDown" enableMouse="true" inherits="SecureActionButtonTemplate" virtual="true">
        <Size x="44" y="44"></Size>
        <Anchors>
            <Anchor point="TOPLEFT" relativePoint="TOPLEFT" x="10" y="-10"></Anchor>
        </Anchors>
            <Layers>
                <Layer level="BACKGROUND" >
                <Texture parentKey="outline" file="Interface\AddOns\GW2_UI\textures\talents\background_border">
                    <Size x="54" y="54"></Size>
                      <Anchors>
                        <Anchor point="CENTER" relativePoint="CENTER"></Anchor>
                    </Anchors>
                </Texture>
            </Layer>
                <Layer level="ARTWORK">
                    <Texture parentKey="icon" textureSubLevel="2">

                        <Anchors>
                            <Anchor point="TOPLEFT" relativePoint="TOPLEFT" x="0" y="0"></Anchor>
                            <Anchor point="BOTTOMRIGHT" relativePoint="BOTTOMRIGHT" x="0" y="0"></Anchor>
                        </Anchors>
                        <TexCoords left="0.1" right="0.9" top="0.1" bottom="0.9" />
                    </Texture>
                </Layer>
                <Layer level="OVERLAY">
                    <Texture  alphaBlend="ADD" file="Interface\AddOns\GW2_UI\textures\talents\active_highlight" parentKey="highlight">
                          <Size x="44" y="44"></Size>
                         <Anchors>
                        <Anchor point="CENTER" relativePoint="CENTER"></Anchor>
                    </Anchors>
                        <Color r="1" b="0.6" g="1" a="0.9"></Color>
                    </Texture>
                    <Texture   file="Interface\AddOns\GW2_UI\textures\talents\active_highlight" parentKey="legendaryHighlight" hidden="true">
                          <Size x="44" y="44"></Size>
                         <Anchors>
                        <Anchor point="CENTER" relativePoint="CENTER"></Anchor>
                    </Anchors>
                        <Color r="1" g="0.662" b="0.13" a="0.9"></Color>
                    </Texture>
                </Layer>
                <Layer level="OVERLAY" textureSubLevel="2">
                    <FontString parentKey="points" text="10/10" justifyH="CENTER" justifyY="CENTER">

                         <Anchors>
                             <Anchor point="TOP" relativePoint="BOTTOM" x="0" y="0"></Anchor>
                         </Anchors>
                     </FontString>
                </Layer>

        </Layers>
        <Scripts>
            <OnEnter>

                GameTooltip:SetOwner(self, "ANCHOR_TOPLEFT",0,0);
                GameTooltip:ClearLines();

                GameTooltip:SetTalent(self.talentFrameId,self.talentid)
                GameTooltip:Show()
            </OnEnter>
            <OnLeave>
                GameTooltip:Hide()
            </OnLeave>
            <OnDragStart>
               if InCombatLockdown() or self.isPassive  then return end

            --    PickupSpell(self.spellId)
            </OnDragStart>
            <OnClick>
                    LearnTalent(self.talentFrameId, self.talentid);
            </OnClick>

        </Scripts>
    </Button>

    <Frame name="GwTalentLine" virtual="true">
        <Size x="66" y="124"></Size>
        <Anchors>
            <Anchor point="TOPLEFT" relativePoint="TOPLEFT" x="245" y="-5"></Anchor>
        </Anchors>
        <Layers>
            <Layer level="BACKGROUND">
                <Texture parentKey="line" file="Interface\AddOns\GW2_UI\textures\talents\line">
                    <Size x="66" y="66"></Size>

                </Texture>
            </Layer>
        </Layers>
    </Frame>


    <Frame name="GwSpellbookMenu" inherits="SecureHandlerStateTemplate,SecureHandlerAttributeTemplate,SecureHandlerShowHideTemplate" virtual="true">
        <Size x="241" y="621"></Size>
        <Anchors>
            <Anchor point="TOPLEFT" relativePoint="TOPLEFT" x="0" y="-10"></Anchor>
        </Anchors>
        <Layers>
            <Layer level="BACKGROUND" textureSubLevel="-2">
                <Texture file="Interface\AddOns\GW2_UI\textures\talents\spellbookmenu_background">
                    <Size x="241" y="512"></Size>
                    <Color r="1" g="1" b="1" a="1"></Color>
                    <Anchors>
                        <Anchor point="TOPLEFT" relativePoint="TOPLEFT" x="0" y="8"></Anchor>
                    </Anchors>
                </Texture>
            </Layer>
        </Layers>
        <Frames>



        </Frames>


    </Frame>
    <Button name="GwspellbookTab"  inherits="SecureHandlerClickTemplate,SecureHandlerShowHideTemplate,SecureHandlerStateTemplate" virtual="true">
        <Size x="231" y="44"></Size>
        <Anchors>
            <Anchor point="TOPLEFT" relativePoint="TOPLEFT" x="0" y="0"></Anchor>
        </Anchors>
        <RelInset left="0.2" right="-0.2" top="0.2" bottom="0"/>
        <Layers>
            <Layer level="BACKGROUND" >
                <Texture parentKey="bg" file="Interface\AddOns\GW2_UI\textures\character\menu-bg">
                    <Anchors>
                        <Anchor point="TOPLEFT" relativePoint="TOPLEFT" x="0" y="0"></Anchor>
                         <Anchor point="BOTTOMRIGHT" relativePoint="BOTTOMRIGHT" x="0" y="0"></Anchor>
                    </Anchors>
                    <Texture parentKey="bgstatic" file="Interface\AddOns\GW2_UI\textures\character\menu-bg">
                        <Anchors>
                            <Anchor point="TOPLEFT" relativePoint="TOPLEFT" x="0" y="0"></Anchor>
                             <Anchor point="BOTTOMRIGHT" relativePoint="BOTTOMRIGHT" x="0" y="0"></Anchor>
                        </Anchors>
                    </Texture>

                </Texture>
            </Layer>
            <Layer level="BORDER">
                <Texture parentkey="icon" file="Interface\AddOns\GW2_UI\textures\talents\tabicon_general">
                    <Size x="32" y="32"></Size>
                    <Anchors>
                        <Anchor point="LEFT" relativePoint="LEFT" x="10" y="0"></Anchor>
                    </Anchors>
                    <TexCoords left="0.1" right="0.9" top="0.1" bottom="0.9" />
                </Texture>
                <FontString parentKey="title" text="Unknown" justifyH="LEFT" justifyY="CENTER">
                    <Size x="32" y="32"></Size>
                    <Anchors>
                       <Anchor point="LEFT" relativePoint="RIGHT" relativeKey="$parent.icon" x="5" y="0"></Anchor>
                        <Anchor point="RIGHT" relativePoint="RIGHT"  x="5" y="0"></Anchor>
                    </Anchors>
                </FontString>
            </Layer>
        </Layers>

    </Button>

    <ScrollFrame name="GwSpellbookContainerTab" virtual="true">
        <Size x="611" y="601"></Size>
        <Anchors>
            <Anchor point="TOPLEFT" relativePoint="TOPLEFT" x="241" y="-37"></Anchor>
            <Anchor point="BOTTOMRIGHT" relativePoint="BOTTOMRIGHT" x="0" y="0"></Anchor>
        </Anchors>
        <Layers>
            <Layer level="BACKGROUND">
                <Texture parentKey="headerbg" file="Interface\AddOns\GW2_UI\textures\talents\talents_header">
                    <Size x="512" y="32"></Size>
                    <Anchors>
                        <Anchor point="BOTTOMLEFT" relativePoint="TOPLEFT" x="0" y="0"></Anchor>
                    </Anchors>
                </Texture>
             </Layer>
             <Layer level="BORDER">
                 <FontString parentKey="title" text="Unknown" justifyH="LEFT" justifyY="CENTER">
                     <Anchors>
                        <Anchor point="LEFT" relativePoint="LEFT" relativeKey="$parent.headerbg" x="5" y="0"></Anchor>
                     </Anchors>
                 </FontString>
             </Layer>
         </Layers>
        <Frames>
            <Frame parentKey="scrollchild" enableMouse="false">
                <Size x="608" y="601"></Size>
                <Anchors>
                    <Anchor point="TOPLEFT" relativePoint="TOPLEFT" x="0" y="0" />
                    <Anchor point="BOTTOMRIGHT" relativePoint="BOTTOMRIGHT" x="0" y="0" />
                </Anchors>
            </Frame>

            <Slider name="$parentSlider" parentKey="slider" orientation="VERTICAL" enableMouse="true" virtual="true">
                <Size x="12" y="12"></Size>
                <Anchors>
                    <Anchor point="TOPRIGHT" relativePoint="TOPRIGHT" x="0" y="-12"></Anchor>
                    <Anchor point="BOTTOMRIGHT" relativePoint="BOTTOMRIGHT" x="0" y="12"></Anchor>
                </Anchors>


                <ThumbTexture name="$parentThumb" parentKey="thumb" file="Interface\AddOns\GW2_UI\textures\scrollbarmiddle">
                    <Size x="12" y="100"/>
                     <Anchors>
                      <Anchor point="TOP" relativePoint="TOP" ></Anchor>
                    </Anchors>
                </ThumbTexture>
                <Layers>
                    <Layer>
                        <Texture file="Interface\AddOns\GW2_UI\textures\scrollbg">
                            <Anchors>
                                <Anchor point="TOP" relativePoint="TOP"></Anchor>
                                <Anchor point="BOTTOM" relativePoint="BOTTOM"></Anchor>
                            </Anchors>
                        </Texture>
                    </Layer>
                </Layers>
                <Scripts>
                    <OnValueChanged>
                        if InCombatLockdown() then return end
                        self:GetParent():SetVerticalScroll(value)
                    </OnValueChanged>
                    <OnLoad>
                        self:SetValue(1)
                    </OnLoad>
                </Scripts>
            </Slider>
            <Button name="$parentScrollButtonUp">
             <Size x="12" y="12"></Size>
                <Anchors>
                    <Anchor point="TOPRIGHT" relativePoint="TOPRIGHT" x="0" y="0"></Anchor>
                </Anchors>
            <Layers>
                <Layer>
                    <Texture file="Interface\AddOns\GW2_UI\textures\scrollbutton">
                        <Size x="12" y="12"></Size>
                            <Anchors>
                                <Anchor point="TOP" relativePoint="TOP"></Anchor>
                            </Anchors>
                    </Texture>
                </Layer>
            </Layers>
            </Button>         <Button name="$parentScrollButtonDown">
             <Size x="12" y="12"></Size>
                <Anchors>
               <Anchor point="BOTTOMRIGHT" relativePoint="BOTTOMRIGHT" x="0" y="0"></Anchor>
                </Anchors>
            <Layers>
                <Layer>
                    <Texture file="Interface\AddOns\GW2_UI\textures\scrollbutton">
                        <Size x="12" y="12"></Size>
                            <Anchors>
                                <Anchor point="TOP" relativePoint="TOP"></Anchor>
                            </Anchors>
                          <TexCoords left="0" right="1" top="1" bottom="0" />
                    </Texture>
                </Layer>
            </Layers>
            </Button>
             </Frames>
             <Scripts>
                 <OnLoad>
                     self:SetScrollChild(self.scrollchild)
                     self.slider:SetMinMaxValues(0,608)
                 </OnLoad>
             <OnMouseWheel>
                 if InCombatLockdown() then return end
                 delta = -delta * 15

                 local s = self:GetVerticalScroll() + delta

                 local min,max =self.slider:GetMinMaxValues()
                 s = math.min(max,math.max(min,s))

                 self.slider:SetValue(s)
                 self:SetVerticalScroll(s)
             </OnMouseWheel>
                 </Scripts>
         </ScrollFrame>

    <Frame name="GwSpellbookActionBackground" virtual="true">
         <Size x="304" y="64"></Size>
         <Anchors>
             <Anchor point="TOPLEFT" relativePoint="TOPLEFT" x="0" y="0"></Anchor>
         </Anchors>
         <Layers>
                  <Layer level="BACKGROUND">

                  </Layer>
             <Layer level="BORDER">
                 <FontString parentKey="title" text="Unknown" justifyH="LEFT" justifyY="CENTER">
                     <Size x="256" y="20"></Size>
                     <Anchors>
                        <Anchor point="TOPLEFT" relativePoint="TOPLEFT" x="15" y="-10"></Anchor>
                     </Anchors>
                 </FontString>
             </Layer>
         </Layers>
         <Scripts>
             <OnLoad>
                 self.title:SetFont(DAMAGE_TEXT_FONT,14,"OUTLINE")
             </OnLoad>
         </Scripts>

     </Frame>
    <Button name="GwSpellbookActionbutton" enableMouse="true" inherits="SecureActionButtonTemplate,SecureHandlerDragTemplate" virtual="true">
         <Size x="40" y="40"></Size>
                    <Layers>
                <Layer level="BACKGROUND" >
                <Texture parentKey="outline" file="Interface\AddOns\GW2_UI\textures\talents\background_border">
                    <Size x="50" y="50"></Size>
                      <Anchors>
                        <Anchor point="CENTER" relativePoint="CENTER"></Anchor>
                    </Anchors>
                </Texture>
            </Layer>
                <Layer level="ARTWORK">
                    <Texture parentKey="icon" textureSubLevel="2">

                        <Anchors>
                            <Anchor point="TOPLEFT" relativePoint="TOPLEFT" x="0" y="0"></Anchor>
                            <Anchor point="BOTTOMRIGHT" relativePoint="BOTTOMRIGHT" x="0" y="0"></Anchor>
                        </Anchors>
                        <TexCoords left="0.1" right="0.9" top="0.1" bottom="0.9" />
                    </Texture>
                </Layer>
                <Layer level="OVERLAY" >
                    <Texture   file="Interface\AddOns\GW2_UI\textures\party\manage-group-arrow" parentKey="arrow">
                        <Size x="16" y="32"></Size>
                        <Anchors>
                            <Anchor point="RIGHT" relativePoint="RIGHT" x="5"></Anchor>
                        </Anchors>

                    </Texture>
                </Layer>
                <Layer level="OVERLAY" textureSubLevel="2">
                    <Texture   file="Interface\AddOns\GW2_UI\textures\talents\autocast" parentKey="autocast">
                        <Size x="55" y="55"></Size>
                        <Anchors>
                            <Anchor point="CENTER" relativePoint="CENTER" x="0"></Anchor>
                        </Anchors>
                    </Texture>
                    <Texture   file="Interface\AddOns\GW2_UI\textures\talents\spell-lock" parentKey="lock">

                        <Anchors>
                            <Anchor point="TOPLEFT" relativePoint="TOPLEFT" x="0" y="0"></Anchor>
                            <Anchor point="BOTTOMRIGHT" relativePoint="BOTTOMRIGHT" x="0" y="0"></Anchor>
                        </Anchors>
                    </Texture>
                    <FontString parentKey="rank" text="" justifyH="RIGHT" justifyY="BOTTOM">

                        <Anchors>
                           <Anchor point="BOTTOMRIGHT" relativePoint="BOTTOMRIGHT" x="0" y="0"></Anchor>
                        </Anchors>
                    </FontString>
                </Layer>
                <Layer level="HIGHLIGHT">
                    <Texture  alphaBlend="ADD" file="Interface\AddOns\GW2_UI\textures\talents\active_highlight" parentKey="highlight">
                          <Size x="40" y="40"></Size>
                         <Anchors>
                        <Anchor point="CENTER" relativePoint="CENTER"></Anchor>
                    </Anchors>
                        <Color r="1" b="0.6" g="1" a="0.9"></Color>
                    </Texture>

                </Layer>

        </Layers>
        <Frames>
            <Cooldown parentKey="cooldown" inherits="CooldownFrameTemplate"/>
        </Frames>
        <Scripts>

            <OnDragStart>
               if InCombatLockdown()  or self.isPassive or self.isFuture then return end

                PickupSpellBookItem(self.spellbookIndex,self.booktype)
            </OnDragStart>
        </Scripts>
    </Button>



    <Frame name="GwLegacyTalentFrame" enableMouse="true" inherits="SecureHandlerBaseTemplate" protected="true" registerForClicks="LeftButtonUp" virtual="true">
    <Size x="853" y="627"></Size>
    <Anchors>
        <Anchor point="TOPLEFT" relativePoint="TOPLEFT" x="0" y="0"></Anchor>
    </Anchors>
    <Layers>
        <Layer level="BACKGROUND">

         </Layer>
        <Layer level="BORDER">
            <FontString parentKey="title" text="Passive" justifyH="LEFT" justifyY="CENTER">
                <Size x="256" y="32"></Size>
                <Anchors>
                   <Anchor point="TOPLEFT" relativePoint="TOPLEFT" x="20" y="-10"></Anchor>
                </Anchors>
            </FontString>

        </Layer>

        </Layers>
        <Frames>
            <Frame parentKey="bottomBar">
                <Size x="853" y="65"></Size>
                <Anchors>
                    <Anchor point="TOPLEFT" relativePoint="TOPLEFT" x="0" y="0"></Anchor>

                </Anchors>
                <Layers>
                    <Layer level="BACKGROUND">
                        <Texture parentKey="background" file="Interface\AddOns\GW2_UI\textures\talents\talents_header">
                            <Size x="512" y="87"></Size>
                            <Anchors>
                                <Anchor point="TOPLEFT" relativePoint="TOPLEFT" x="5" y="-5"></Anchor>
                            </Anchors>
                        </Texture>
                    </Layer>
                    <Layer level="BORDER">
                        <FontString parentKey="unspentPoints" text="10" justifyH="LEFT" justifyY="CENTER">

                            <Anchors>
                               <Anchor point="TOPLEFT" relativePoint="TOPLEFT" relativeKey="$parent.background" x="10" y="-20"></Anchor>
                            </Anchors>
                        </FontString>
                        <FontString parentKey="unspentPointsLabel" text="Unspent talent points" justifyH="LEFT" justifyY="CENTER">

                            <Anchors>
                               <Anchor point="LEFT" relativePoint="RIGHT" relativeKey="$parent.unspentPoints" x="0" y=""></Anchor>
                            </Anchors>
                        </FontString>
                    </Layer>
                </Layers>
            </Frame>
        </Frames>
        <Scripts>
            <OnLoad>

                self.bottomBar.unspentPoints:SetFont(DAMAGE_TEXT_FONT,24,"OUTLINE")
                self.bottomBar.unspentPoints:SetTextColor(0.9,0.9,0.8,1)

                self.bottomBar.unspentPointsLabel:SetFont(DAMAGE_TEXT_FONT,18,"OUTLINE")
                self.bottomBar.unspentPointsLabel:SetTextColor(0.7,0.7,0.5,1)
                self.bottomBar.unspentPointsLabel:SetText(BONUS_TALENTS)



                self.title:SetFont(DAMAGE_TEXT_FONT,14)
                self.title:SetTextColor(1,1,1,1)
                self.title:SetShadowColor(0,0,0,1)
                self.title:SetShadowOffset(1,-1)
                self.title:SetText(GwLocalization['TALENTS_SPEC_HEADER'] )


                --self:RegisterEvent("PREVIEW_TALENT_POINTS_CHANGED");
                self:RegisterEvent("UNIT_MODEL_CHANGED");
                self:RegisterEvent("UNIT_LEVEL");
                self:RegisterEvent("LEARNED_SPELL_IN_TAB");
                self:RegisterEvent("CHARACTER_POINTS_CHANGED");
                self:RegisterEvent("SPELLS_CHANGED");

                --self:RegisterEvent("PLAYER_TALENT_UPDATE");
                --self:RegisterEvent("PET_SPECIALIZATION_CHANGED");
            --    self:RegisterEvent("ACTIVE_TALENT_GROUP_CHANGED");
            --    self:RegisterEvent("PREVIEW_TALENT_PRIMARY_TREE_CHANGED");
            --    self:RegisterEvent("PLAYER_LEARN_TALENT_FAILED");
            </OnLoad>
        </Scripts>
    </Frame>

    <Frame name="GwLegacyTalentTree" enableMouse="true"  registerForClicks="LeftButtonUp" virtual="true">
    <Size x="284" y="535"></Size>
    <Anchors>
        <Anchor point="TOPLEFT" relativePoint="TOPLEFT" x="0" y="0"></Anchor>
    </Anchors>
    <Layers>
        <Layer level="BACKGROUND">
            <Texture parentKey="background"  file="Interface\AddOns\GW2_UI\textures\talents\talents_header">
                <Size x="284" y="611"></Size>
                <Anchors>
                    <Anchor point="TOPLEFT" relativePoint="TOPLEFT" x="0" y="0"></Anchor>
                    <Anchor point="BOTTOMRIGHT" relativePoint="BOTTOMRIGHT" x="0" y="0"></Anchor>
                </Anchors>
                <Color r="0.7" g="0.7" b="0.7" a="0.5"></Color>
                <TexCoords left="0.15625" right="0.4306640625" top="0.025390625" bottom="0.6220703125" />
            </Texture>
            </Layer>
        </Layers>
        <Frames>
            <Frame parentKey="info" >
                <Size x="284" y="32"></Size>
                <Anchors>
                    <Anchor point="TOPLEFT" relativePoint="TOPLEFT" x="0" y="32"></Anchor>
                </Anchors>
                <Layers>
                    <Layer level="BACKGROUND">

                    </Layer>
                    <Layer level="BORDER">
                        <FontString parentKey="title" text="" justifyH="LEFT" justifyY="CENTER">
                            <Anchors>
                                <Anchor point="TOPLEFT" relativePoint="TOPLEFT"  x="10" y="10"></Anchor>
                                    <Anchor point="BOTTOMRIGHT" relativePoint="BOTTOMRIGHT"  x="10" y="-10"></Anchor>
                            </Anchors>
                        </FontString>
                        <FontString parentKey="points" text="20" justifyH="RIGHT" justifyY="CENTER">
                            <Anchors>
                                <Anchor point="TOPLEFT" relativePoint="TOPLEFT"  x="10" y="10"></Anchor>
                                    <Anchor point="BOTTOMRIGHT" relativePoint="BOTTOMRIGHT"  x="-10" y="-10"></Anchor>
                            </Anchors>
                        </FontString>
                    </Layer>
                </Layers>
            </Frame>
                <Frame parentKey="treeContainer" >
                    <Anchors>
                        <Anchor point="TOPLEFT" relativePoint="TOPLEFT" x="5" y="-20"></Anchor>
                        <Anchor point="BOTTOMRIGHT" relativePoint="BOTTOMRIGHT" x="-5" y="5"></Anchor>
                    </Anchors>
                </Frame>

        </Frames>
        <Scripts>
            <OnLoad>
                self.info.title:SetFont(DAMAGE_TEXT_FONT,14,"OUTLINE")
                self.info.points:SetFont(DAMAGE_TEXT_FONT,20,"OUTLINE")

                self.info.points:SetTextColor(0.7,0.7,0.5,1)


            </OnLoad>
            <OnShow>
                self:SetScript('OnUpdate',function(self,elapsed)
                    if MouseIsOver(self) then
                        local r,g,b,a = self.background:GetVertexColor()
                        r = math.min(0.8,r+(1 * elapsed))
                        self.background:SetVertexColor(r,r,r,r)
                        return
                    end
                    self.background:SetVertexColor(0.7,0.7,0.7,0.5)
                end)
            </OnShow>
            <OnHide>
                 self:SetScript('OnUpdate',nil)
            </OnHide>
        </Scripts>
    </Frame>
    <Frame name="GwLegacyTalentLine" virtual="true">
        <Size x="44" y="44"></Size>
        <Layers>
            <Layer level="BACKGROUND"  textureSubLevel="-1">>
                <Texture parentKey="down" file="Interface\AddOns\GW2_UI\textures\talents\talent_line" hidden="true">
                    <Size x="100" y="75"></Size>
                    <Anchors>
                        <Anchor point="TOP" relativePoint="CENTER" x="0" y="5"></Anchor>
                    </Anchors>
                    <Color r="1" b="0.6" g="1" a="1"></Color>
                </Texture>
                <Texture parentKey="up" file="Interface\AddOns\GW2_UI\textures\talents\talent_line" hidden="true">
                    <Size x="100" y="75"></Size>
                    <Anchors>
                        <Anchor point="BOTTOM" relativePoint="CENTER" x="0" y="-5"></Anchor>
                    </Anchors>
                    <Color r="1" b="0.6" g="1" a="1"></Color>
                </Texture>
                <Texture parentKey="left" file="Interface\AddOns\GW2_UI\textures\talents\talent-line-left" hidden="true">
                    <Size x="70" y="100"></Size>
                    <Anchors>
                        <Anchor point="RIGHT" relativePoint="CENTER" x="5" y="0"></Anchor>
                    </Anchors>
                    <Color r="1" b="0.6" g="1" a="1"></Color>
                </Texture>
                <Texture parentKey="right" file="Interface\AddOns\GW2_UI\textures\talents\talent-line-left" hidden="true">
                    <Size x="70" y="100"></Size>
                    <Anchors>
                        <Anchor point="LEFT" relativePoint="CENTER" x="-5" y="0"></Anchor>
                    </Anchors>
                    <Color r="1" b="0.6" g="1" a="1"></Color>
                </Texture>
            </Layer>
        </Layers>
    </Frame>

</Ui>
